<!doctype html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tech Career Paths</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      body { box-sizing: border-box; }
      .font-display { font-family: 'Space Mono', monospace; }
      .font-body { font-family: 'DM Sans', sans-serif; }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      @keyframes slideIn {
        from { opacity: 0; transform: translateX(-30px); }
        to { opacity: 1; transform: translateX(0); }
      }
      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.02); }
      }

      .animate-fade { animation: fadeIn 0.6s ease-out forwards; }
      .animate-slide { animation: slideIn 0.5s ease-out forwards; }
      .animate-pulse-slow { animation: pulse 3s ease-in-out infinite; }

      .stat-card {
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
      }
      .stat-card:hover { transform: translateY(-2px); }

      .progress-bar { transition: width 1s ease-out; }
      .scenario-option { transition: all 0.2s ease; }
      .scenario-option:hover { transform: translateX(4px); }

      .character-card { transition: all 0.3s ease; }
      .character-card:hover { transform: scale(1.02); }

      .timeline-dot { transition: all 0.3s ease; }
      .timeline-dot.active { transform: scale(1.3); }
    </style>

    <style>@view-transition { navigation: auto; }</style>
  </head>

  <body class="h-full font-body">
    <div id="app" class="h-full w-full overflow-auto"></div>

    <script>
      // ---------------------------
      // Config
      // ---------------------------
      const defaultConfig = {
        background_color: '#ffffff',
        surface_color: '#f8faf8',
        text_color: '#24423A',
        primary_action: '#6BC285',
        secondary_action: '#24423A',
        font_family: 'DM Sans',
        font_size: 16,
        game_title: 'Parallel Paths',
        intro_heading: 'Four Careers, One Industry'
      };
      let config = { ...defaultConfig };

      // ---------------------------
      // Characters
      // ---------------------------
      const characters = {
        alex: {
          name: 'Alex Chen',
          identity: 'Man, majority background, Canadian-born',
          emoji: 'üë®‚Äçüíª',
          description: "Alex graduated top of his class with a CS degree. He's ambitious, hardworking, and ready to make his mark in tech."
        },
        jordan: {
          name: 'Jordan Williams',
          identity: 'Woman, Black Canadian, born in Canada',
          emoji: 'üë©‚Äçüíª',
          description: "Jordan graduated top of her class with a CS degree. She's ambitious, hardworking, and ready to make her mark in tech."
        },
        priya: {
          name: 'Priya Sharma',
          identity: 'Woman, South Asian, immigrated to Canada',
          emoji: 'üë©‚Äçüíª',
          description: "Priya earned her engineering degree abroad and built strong experience before landing her first Canadian tech role. She's highly skilled and excited to grow here."
        },
        jerry_indigenous: {
          name: 'Jerry Chartrand',
          identity: 'Man, Metis, from Manitoba',
          emoji: 'üë®‚Äçüíª',
          description: "Jerry grew up with limited access to tech resources, learned through community programs and online learning, and built a strong portfolio. He's self-driven and determined."
        }
      };

      // ---------------------------
      // Starting stats (single source of truth)
      // ---------------------------
      const startingStatsByCharacter = {
        alex: { salary: 75000, promotions: 0, confidence: 80, burnout: 10, mentors: 0 },
        jordan: { salary: 75000, promotions: 0, confidence: 80, burnout: 10, mentors: 0 },
        priya: { salary: 72000, promotions: 0, confidence: 75, burnout: 15, mentors: 0 },
        jerry_indigenous: { salary: 75000, promotions: 0, confidence: 80, burnout: 10, mentors: 0 }
      };

      // ---------------------------
      // Game state
      // ---------------------------
      let gameState = {
        screen: 'intro', // intro, select, playing, stats
        selectedCharacter: null,
        currentScenario: 0,

        alexStats: { ...startingStatsByCharacter.alex },
        jordanStats: { ...startingStatsByCharacter.jordan },
        priyaStats: { ...startingStatsByCharacter.priya },
        jerry_indigenousStats: { ...startingStatsByCharacter.jerry_indigenous }
      };

      // ---------------------------
      // Scenarios
      // IMPORTANT: every scenario is ONE complete object: { year, title, situations, outcomes, stat?, solutions? }
      // ---------------------------
      const scenarios = [
        {
          year: 1,
          title: 'First Day Onboarding',
          situations: {
            alex: "You arrive for your first day. Your manager introduces you to the team and walks you through the office.",
            jordan: "Your onboarding covers the basics. Everyone‚Äôs super nice, but most of the real tips get shared in quick little chats that happen before you even know you should be paying attention.",
            priya: "The onboarding assumes you already know how things work around here. Acronyms, tools, and the unwritten rules don‚Äôt really get explained, and you‚Äôre not always sure when it‚Äôs okay to jump in with questions.",
            jerry_indigenous: "People are welcoming, but the small talk hits differently. When everyone starts chatting about Canada Day plans, you go quiet. You also notice there‚Äôs no Indigenous representation in the onboarding materials or examples ‚Äî everything kind of assumes a default experience that isn‚Äôt yours."},
          outcomes: {
            alex: { salaryChange: 0, confidenceChange: 10, burnoutChange: 0, mentorChange: 1, promoted: null,
              text: "You get clear context, quick access to people, and early encouragement. You feel confident walking into your first tasks." },
            jordan: { salaryChange: 0, confidenceChange: -10, burnoutChange: 10, mentorChange: 0, promoted: null,
              text: "Nothing really goes wrong, but you quickly notice that info kind of travels by word of mouth. You notice you‚Äôre more careful about how you speak and when you ask questions." },
            priya: { salaryChange: 0, confidenceChange: -15, burnoutChange: 15, mentorChange: 0, promoted: null,
              text: "You spend extra time double-checking your work and replaying conversations afterward. You‚Äôre working hard, but it seems like it's taking more effort than normal." },
            jerry_indigenous: { salaryChange: 0, confidenceChange: -10, burnoutChange: 5, mentorChange: 0, promoted: null,
              text: "You‚Äôre excited to start, but you quickly realize you‚Äôll need to do extra emotional work to ‚Äòfit in‚Äô‚Äîfiguring out when to explain things and when to just stay quiet. It‚Äôs never a big deal in the moment, but it adds up and starts to feel heavy." }
          },
          stat: {
            title: "Early Career Experiences Matter",
            value: "Small differences in onboarding, access to information, and informal support can compound over time‚Äîshaping confidence, visibility, and opportunity long before performance reviews begin.",
            source: "Canadian Tech Workforce Research"
          },
          solutions: {
            forIndividuals: [
              { title: 'Ask for a ‚Äúworking map‚Äù', desc: 'In week one, ask: ‚ÄúWho owns what? Where do we document decisions? What does ‚Äògood‚Äô look like here?‚Äù It‚Äôs a calm, practical way to reduce ambiguity.' },
              { title: 'Find one safe teammate', desc: 'Not a formal mentor yet‚Äîjust one person you can ask quick ‚Äúis this normal?‚Äù questions without feeling judged.' },
              { title: 'Normalize clarifying questions', desc: 'Try: ‚ÄúQuick check so I don‚Äôt miss anything‚Äîdo we prefer X or Y?‚Äù It signals competence, not uncertainty.' }
            ],
            forLeaders: [
              { title: 'Make onboarding explicit', desc: 'Spell out acronyms, norms, and ‚Äúhow we work.‚Äù Don‚Äôt rely on people to decode the culture.' },
              { title: 'Pair new hires intentionally', desc: 'Assign a buddy responsible for introductions + early context (not just ‚Äúask if you need anything‚Äù).' },
              { title: 'Measure belonging early', desc: 'Ask new hires at week 2 and week 6: ‚ÄúWhat surprised you? What‚Äôs unclear? What‚Äôs hard to access?‚Äù Then act on it.' }
            ]
          }
        },

        {
          year: 1,
          title: 'Networks & Belonging',
         situations: {
  alex: 'Your education comes up casually. People recognize your school, swap stories, and you‚Äôre quickly ‚Äúplaced‚Äù in the informal hierarchy.',
  jordan: 'Your education comes up too, but you notice you‚Äôre still asked to re-explain basics others aren‚Äôt. It‚Äôs subtle‚Äîlike trust takes longer to settle.',
  priya: 'Your degree is solid, but parts of it aren‚Äôt automatically recognized the same way here. You spend evenings navigating credential assessments, local course equivalents, and ‚ÄúCanadian experience‚Äù expectations‚Äîon top of doing the job.',
  jerry_indigenous: 'You take a training module that talks about career paths and ‚Äòleadership behaviours,‚Äô but none of the examples feel familiar. You also notice how often people bond over shared networks ‚Äî who they know, where they‚Äôve worked, mutual friends. Those connections make things flow for them, and you realize you don‚Äôt have the same entry points.'
},
outcomes: {
  alex: { salaryChange: 0, confidenceChange: 15, burnoutChange: 0, mentorChange: 1, promoted: null,
    text: "Your background becomes a quiet credibility boost. People assume competence and involve you early in technical conversations." },
  jordan: { salaryChange: 0, confidenceChange: -10, burnoutChange: 10, mentorChange: 0, promoted: null,
    text: "You‚Äôre doing well, but you notice trust builds slower. You compensate by over-preparing and staying ‚Äúon‚Äù in ways others don‚Äôt." },
  priya: { salaryChange: 0, confidenceChange: -15, burnoutChange: 15, mentorChange: 0, promoted: null,
    text: "You‚Äôre capable, but you‚Äôre carrying extra administrative and credibility work outside the job. It delays your ability to take on bigger ownership." },
  jerry_indigenous: { salaryChange: 0, confidenceChange: -10, burnoutChange: 10, mentorChange: 0, promoted: null,
    text: "You‚Äôre fully qualified, but you can feel the difference between being included and just being accommodated. Without shared networks or people who reflect your experience, you end up spending more energy trying to figure out who you can trust." }
},
          
         stat: {
  title: 'Networks & Belonging',
  value: "Traditional credentials still influence how quickly people are trusted‚Äîespecially early on‚Äîdespite strong performance and real-world skill.",
  source: 'Canadian workforce & hiring research'
}
},
{
    year: 2,
          title: 'The Code Review Dynamic',
          situations: {
            alex: "Your code review feedback focuses on technical merit and architecture decisions.",
            jordan: "Your code is solid, but feedback includes more ‚Äútone‚Äù and ‚Äúclarity‚Äù notes than technical notes.",
            priya: "Your reviews take a while to come back, and when they do, most of the feedback is about things like formatting, documentation, and making sure your work is super easy for others to follow.",
            jerry_indigenous: "You suggest a solution that focuses on resilience and long‚Äëterm stability ‚Äî thinking about real‚Äëworld limits and spotty connectivity. The review feedback is polite, but it nudges you back toward ‚Äòthe usual way‚Äô without really digging into your reasoning.",
          },
          outcomes: {
            alex: { salaryChange: 0, confidenceChange: 15, burnoutChange: 0, mentorChange: 1, promoted: null,
              text: "You‚Äôre pulled into deeper technical conversations and invited to design discussions." },
            jordan: { salaryChange: 0, confidenceChange: -10, burnoutChange: 10, mentorChange: 0, promoted: null,
              text: "You begin anticipating feedback before it happens‚Äîadding context, softening language, explaining tradeoffs others don‚Äôt have to. Your work quality stays high, but the mental load increases." },
            priya: { salaryChange: 0, confidenceChange: -15, burnoutChange: 15, mentorChange: 0, promoted: null,
              text: "You start guessing the questions people might ask and add extra explanation right from the start. The work turns out great but it takes longer and you wonder if you're overthinking things." },
            jerry_indigenous: { salaryChange: 0, confidenceChange: -15, burnoutChange: 10, mentorChange: 0, promoted: null,
              text: "Your work is solid, but it‚Äôs on you to explain any idea that doesn‚Äôt match the usual style. After a while, you start simplifying your thinking just to avoid pushback ‚Äî even when your original approach would‚Äôve helped users more" }
          },
          stat: {
            title: 'Feedback Bias',
            value: 'People from underrepresented groups often receive more subjective feedback (style, tone, ‚Äúpresence‚Äù) versus objective feedback (technical decisions).',
            source: 'Workplace feedback research'
          },
          solutions: {
            forIndividuals: [
              { title: 'Redirect to specifics', desc: 'Try: ‚ÄúHelpful‚Äîwhat‚Äôs the technical risk you‚Äôre worried about?‚Äù or ‚ÄúWhat would ‚Äòclear‚Äô look like here?‚Äù' },
              { title: 'Ask for examples', desc: 'If feedback is vague, request a concrete example: ‚ÄúCan you point to the line and show the preferred pattern?‚Äù' },
              { title: 'Name the pattern calmly', desc: 'In a 1:1: ‚ÄúI‚Äôm noticing I get a lot of style feedback. Can we align on the team standard so I‚Äôm not guessing?‚Äù' }
            ],
            forLeaders: [
              { title: 'Use a review rubric', desc: 'Separate technical concerns from preferences. Apply the same standard across people.' },
              { title: 'Audit review comments', desc: 'Spot patterns: who gets ‚Äútone‚Äù feedback? who gets ‚Äúarchitecture‚Äù feedback? Then adjust.' },
              { title: 'Normalize objective language', desc: 'Model ‚Äúimpact-based‚Äù feedback instead of personal feedback.' }
            ]
          }
        },

        {
          year: 3,
          title: 'Promotion Opportunity',
          situations: {
            alex: "You‚Äôre recommended for a more senior role. Your manager advocates for you early.",
            jordan: "You‚Äôve met the documented requirements, but feedback focuses on ‚Äòvisibility‚Äô and ‚Äòreadiness‚Äô‚Äîwithout concrete examples or timelines.",
            priya: "You‚Äôve been operating at the next level for months. When promotion discussions finally happen, the criteria feel loosely defined and timelines are vague.",
            jerry_indigenous: "You‚Äôve delivered solid results again and again, but promotion chats still feel informal ‚Äî shaped by who people already see as ‚Äòleadership material.‚Äô Leadership roles emphasize visibility, decisiveness, and individual ownership. Your leadership style is quieter and collective."
          },
          outcomes: {
            alex: { salaryChange: 12000, confidenceChange: 20, burnoutChange: 0, mentorChange: 1, promoted: true,
              text: "You get the title change and a clear scope increase. Your manager celebrates it publicly." },
            jordan: { salaryChange: 2000, confidenceChange: -20, burnoutChange: 20, mentorChange: 0, promoted: false,
              text: "You receive a small raise but no role change. The feedback isn‚Äôt negative, but it‚Äôs vague enough that planning your next move feels harder." },
            priya: { salaryChange: 8500, confidenceChange: -15, burnoutChange: 15, mentorChange: 0, promoted: true,
             text: "You‚Äôre promoted, but the raise doesn‚Äôt fully reflect the expanded scope. With expectations unclear, pushing harder feels uncertain rather than empowering." },
            jerry_indigenous: { salaryChange: 3000, confidenceChange: -25, burnoutChange: 25, mentorChange: 0, promoted: false,
              text: "You‚Äôre seen as reliable and thoughtful, but not ‚Äòleadership-ready.‚Äô No one can clearly explain what‚Äôs missing." }
          },
          stat: {
            title: 'The Promotion Gap',
            value: 'Promotion processes often rely on informal sponsorship and subjective criteria‚Äîcreating uneven outcomes even with strong performance.',
            source: 'Workplace promotion research'
          },
          solutions: {
            forIndividuals: [
              {title: 'Reduce the Risk of Advocacy', desc: 'Frame advocacy as alignment, not confrontation. Try: ‚ÄúI want to make sure I‚Äôm investing my energy in the right things‚Äîwhat evidence would signal I‚Äôm ready for the next level?‚Äù Follow up with a recap in writing.'},
              { title: 'Ask for criteria in writing', desc: 'Try: ‚ÄúWhat are the specific expectations for the next level‚Äîand how will we measure them?‚Äù' },
              { title: 'Time-box the trial', desc: 'If asked to do higher-level work first, propose a review date: ‚ÄúLet‚Äôs reassess in 6‚Äì8 weeks with clear outcomes.‚Äù' },
              { title: 'Ask for sponsorship', desc: 'Use plain language: ‚ÄúIf I‚Äôm aiming for the next level, who will advocate for me in the room I‚Äôm not in?‚Äù' }
            ],
            forLeaders: [
              { title: 'Make criteria measurable', desc: 'Reduce ‚Äúpresence‚Äù vagueness. Define examples of senior-level behaviors and outcomes.' },
              { title: 'Stop endless trials', desc: 'If someone performs at the next level, formalize the role and compensation.' },
              { title: 'Track outcomes by group', desc: 'Look for patterns across identity and address disparities early.' }
            ]
          }
        },

        {
          year: 3,
          title: 'Mentorship & Sponsorship',
          situations: {
            alex: "Senior engineers pull you into conversations and advocate for you informally.",
            jordan: "Mentorship seems to happen through shared history, interests, or proximity. You get advice when you ask‚Äîbut no one is actively pulling you forward.",
            priya: "People help when you ask, but you‚Äôre not part of the casual conversations where future opportunities get talked about.",
            jerry_indigenous: "You look for mentorship, but there‚Äôs no one who really shares your lived experience. People are friendly, but you can feel a bit of hesitation ‚Äî like they don‚Äôt want to say the wrong thing. You end up putting in a lot of relationship work just to get the kind of access others get naturally",
          },
          outcomes: {
            alex: { salaryChange: 0, confidenceChange: 20, burnoutChange: 0, mentorChange: 2, promoted: null,
              text: "You gain sponsors who open doors. You‚Äôre introduced to decision-makers and offered stretch work." },
            jordan: { salaryChange: 0, confidenceChange: -10, burnoutChange: 15, mentorChange: 0, promoted: null,
              text: "You don‚Äôt lack ambition‚Äîyou lack access.You realize mentorship isn‚Äôt just about getting advice ‚Äî it‚Äôs about having someone who speaks up for you. " },
            priya: { salaryChange: 0, confidenceChange: -15, burnoutChange: 20, mentorChange: 0, promoted: null,
              text: "Without someone actively speaking up for you, your progress depends on always going above and beyond ‚Äî not on being seen. This job is important but progress feels slow." },
            jerry_indigenous: { salaryChange: 0, confidenceChange: -15, burnoutChange: 15, mentorChange: 0, promoted: null,
              text: "You don‚Äôt just need advice ‚Äî you need someone who‚Äôll actually speak up for you. But sponsorship isn‚Äôt spread evenly, and you‚Äôre not naturally included in the spaces where those relationships get built." }
          },
          stat: {
            title: 'Sponsorship Is a Multiplier',
            value: 'It‚Äôs not just having a mentor‚Äîit‚Äôs having someone who speaks for you when decisions are made.',
            source: 'Workplace advancement research'
          }
        },

        {
          year: 3,
          title: 'The High-Profile Project',
          situations: {
            alex: "You‚Äôre assigned to a visible project. Your manager frames it as a growth opportunity.",
            jordan: "You put your hand up for a big, visible project, but you‚Äôre given a supporting role instead. The lead spot goes to someone who is more vocal but not more experienced",
            priya: "The lead is chosen before roles are discussed. You‚Äôre assigned maintenance work while others are positioned as ‚Äúclient-facing.‚Äù",
            jerry_indigenous: "You raise concerns about downstream impacts and sustainability. The project moves forward without incorporating them."
          },
          outcomes: {
            alex: { salaryChange: 6000, confidenceChange: 25, burnoutChange: 5, mentorChange: 0, promoted: null,
              text: "The project succeeds. You become known as someone who can lead visible work." },
            jordan: { salaryChange: 1000, confidenceChange: -20, burnoutChange: 20, mentorChange: 0, promoted: null,
              text: "You handle the behind‚Äëthe‚Äëscenes work that keeps everything running. The project turns out great for the team ‚Äî but it doesn‚Äôt really change how people see you." },
            priya: { salaryChange: 0, confidenceChange: -20, burnoutChange: 20, mentorChange: 0, promoted: null,
              text: "Your reliability is valued, but it doesn‚Äôt translate into stretch opportunities." },
            jerry_indigenous: { salaryChange: 0, confidenceChange: -20, burnoutChange: 20, mentorChange: 0, promoted: null,
              text: "Later, some of the risks you flagged surface ‚Äî but credit goes to the team for ‚Äòlessons learned,‚Äô not to you for foresight." }
          },
          stat: {
            title: 'Opportunity Gaps Compound',
            value: 'High-visibility work accelerates careers. When access isn‚Äôt equitable, trajectories diverge quickly.',
            source: 'Workplace opportunity research'
          }
        },

        {
          year: 5,
          title: 'Five Years In: Where You Stand',
          situations: {
            alex: "Your network is strong and you‚Äôre being considered for leadership roles.",
            jordan: "You‚Äôre still in a senior individual contributor role. You enjoy the work‚Äîbut you‚Äôve learned how much extra effort it takes to stay.",
            priya: "You‚Äôve built real expertise and delivered great results again and again, but moving up has taken longer than you expected.",
            jerry_indigenous: "You‚Äôve done strong work, but the effort to break through has been draining."
          },
          outcomes: {
            alex: { salaryChange: 30000, confidenceChange: 25, burnoutChange: -10, mentorChange: 0, promoted: true,
              text: "You‚Äôve advanced quickly. You‚Äôre planning your next step and feel confident in the system."},
            jordan: { salaryChange: 5000, confidenceChange: -20, burnoutChange: -5, mentorChange: 0, promoted: false,
              text: "You‚Äôve built a strong career, but it required constant self-advocacy, adjustment, and restraint. You‚Äôre proud of your skills‚Äîand tired of how much effort it took to have them recognized." },
            priya: { salaryChange: 8000, confidenceChange: -20, burnoutChange: 10, mentorChange: 0, promoted: false,
              text: "People respect your work, but your progress has been uneven. All the adjusting, explaining, and waiting has added up ‚Äî leaving you proud of what you‚Äôve done, just more tired than you thought you‚Äôd be." },
            jerry_indigenous: { salaryChange: 4000, confidenceChange: -20, burnoutChange: 0, mentorChange: 0, promoted: false,
              text: "You‚Äôve grown a lot, but the culture still doesn‚Äôt quite feel built for you. The team talks about flexible remote work, but you can‚Äôt reliably work from your home community because the connectivity just isn‚Äôt there. You feel pulled between growing your career and staying connected to your people" }
          },
          stat: {
            title: 'The Outcome Gap',
            value: 'Career outcomes are shaped by compounding access: information, sponsorship, opportunities, and fair evaluation‚Äînot just effort.',
            source: 'Canadian tech workforce research'
          }
        }
      ];

      // ---------------------------
      // Helpers
      // ---------------------------
      function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }

      function getStats(charKey) {
        return gameState[`${charKey}Stats`];
      }

      // ---------------------------
      // Rendering
      // ---------------------------
      function render() {
        const app = document.getElementById('app');

        const bgColor = config.background_color || defaultConfig.background_color;
        const surfaceColor = config.surface_color || defaultConfig.surface_color;
        const textColor = config.text_color || defaultConfig.text_color;
        const primaryAction = config.primary_action || defaultConfig.primary_action;
        const secondaryAction = config.secondary_action || defaultConfig.secondary_action;
        const fontFamily = config.font_family || defaultConfig.font_family;
        const fontSize = config.font_size || defaultConfig.font_size;
        const gameTitle = config.game_title || defaultConfig.game_title;
        const introHeading = config.intro_heading || defaultConfig.intro_heading;

        app.style.backgroundColor = bgColor;
        app.style.color = textColor;
        app.style.fontFamily = `${fontFamily}, sans-serif`;
        app.style.fontSize = `${fontSize}px`;

        let content = '';

       switch (gameState.screen) {
  case 'intro':
    content = renderIntro(surfaceColor, textColor, primaryAction, secondaryAction, fontSize, gameTitle, introHeading);
    break;

switch (gameState.screen) {

  case 'intro':
    content = renderIntro(
      surfaceColor,
      textColor,
      primaryAction,
      secondaryAction,
      fontSize,
      gameTitle,
      introHeading
    );
    break;

  case 'select':
    content = renderCharacterSelect(
      surfaceColor,
      textColor,
      primaryAction,
      secondaryAction,
      fontSize
    );
    break;

  case 'playing':
    content = renderScenario(
      surfaceColor,
      textColor,
      primaryAction,
      secondaryAction,
      fontSize
    );
    break;

 case 'stats':
  content = renderFinalStats(
    surfaceColor,
    textColor,
    primaryAction,
    secondaryAction,
    fontSize
  );

  setTimeout(() => {
    gameState.screen = 'empower';
    render();
  }, 15000);

  break;

case 'empower':
  content = renderEmpowerment(
    surfaceColor,
    textColor,
    primaryAction,
    secondaryAction,
    fontSize
  );
  break;

  default:
    content = renderIntro(
      surfaceColor,
      textColor,
      primaryAction,
      secondaryAction,
      fontSize,
      gameTitle,
      introHeading
    );
}

        app.innerHTML = content;
      }

      function renderIntro(surfaceColor, textColor, primaryAction, secondaryAction, fontSize, gameTitle, introHeading) {
        return `
          <div class="min-h-full w-full flex items-center justify-center p-4 md:p-8">
            <div class="max-w-3xl w-full text-center animate-fade">
              <div class="mb-8">
                <span class="text-6xl md:text-8xl">‚öñÔ∏è</span>
              </div>

              <h1 class="font-display font-bold mb-4" style="font-size:${fontSize * 3}px; color:${textColor}">
                ${gameTitle}
              </h1>

              <p class="mb-8 opacity-80" style="font-size:${fontSize * 1.25}px; color:${secondaryAction}">
                ${introHeading}
              </p>

              <div class="stat-card rounded-2xl p-6 md:p-8 mb-8" style="background:${surfaceColor}">
                <p class="leading-relaxed opacity-90" style="font-size:${fontSize * 1.125}px">
                  Meet Alex, Jordan, Priya, and Jerry. They start the same job at the same company with strong skills and big goals.
                </p>
                <p class="leading-relaxed mt-4 font-semibold" style="color:${primaryAction}; font-size:${fontSize * 1.125}px">
                  Five years later, their careers look very different‚Äînot because of effort, but because of compounding access and bias.
                </p>
              </div>

              <button onclick="startGame()"
                class="px-8 py-4 rounded-xl font-semibold transition-all hover:scale-105 animate-pulse-slow"
                style="background:${primaryAction}; color:white; font-size:${fontSize * 1.125}px">
                Begin the Journey ‚Üí
              </button>

              <p class="mt-6 text-sm opacity-60" style="font-size:${fontSize * 0.75}px">
                ‚è±Ô∏è Takes about 5 minutes
              </p>
            </div>
          </div>
        `;
      }

      function renderCharacterSelect(surfaceColor, textColor, primaryAction, secondaryAction, fontSize) {
        return `
          <div class="min-h-full w-full flex items-center justify-center p-4 md:p-8">
            <div class="max-w-5xl w-full animate-fade">
              <h2 class="font-display font-bold text-center mb-2" style="font-size:${fontSize * 2}px">
                Choose Your Perspective
              </h2>
              <p class="text-center opacity-70 mb-8" style="font-size:${fontSize}px">
                You‚Äôll see how small moments can compound into different outcomes.
              </p>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                ${Object.entries(characters).map(([key, char]) => `
                  <button onclick="selectCharacter('${key}')"
                    class="character-card text-left rounded-2xl p-6 transition-all ${gameState.selectedCharacter === key ? 'ring-4' : ''}"
                    style="background:${surfaceColor}; ${gameState.selectedCharacter === key ? `ring-color:${primaryAction};` : ''}">
                    <div class="text-5xl mb-4">${char.emoji}</div>
                    <h3 class="font-display font-bold mb-1"
                      style="font-size:${fontSize * 1.5}px; color:${gameState.selectedCharacter === key ? primaryAction : textColor}">
                      ${char.name}
                    </h3>
                    <p class="text-sm opacity-60 mb-3" style="font-size:${fontSize * 0.875}px; color:${secondaryAction}">
                      ${char.identity}
                    </p>
                    <p class="opacity-80" style="font-size:${fontSize * 0.875}px">
                      ${char.description}
                    </p>
                  </button>
                `).join('')}
              </div>

              <div class="text-center">
                <button onclick="beginScenarios()"
                  class="px-8 py-4 rounded-xl font-semibold transition-all ${gameState.selectedCharacter ? 'hover:scale-105' : 'opacity-50 cursor-not-allowed'}"
                  style="background:${primaryAction}; color:white; font-size:${fontSize * 1.125}px"
                  ${!gameState.selectedCharacter ? 'disabled' : ''}>
                  Start ‚Üí
                </button>
              </div>
            </div>
          </div>
        `;
      }

      function renderScenario(surfaceColor, textColor, primaryAction, secondaryAction, fontSize) {
        const scenario = scenarios[gameState.currentScenario];
        const charKey = gameState.selectedCharacter;
        const char = characters[charKey];
        const outcome = scenario.outcomes[charKey];
        const stats = getStats(charKey);

        const progressPct = ((gameState.currentScenario + 1) / scenarios.length) * 100;

        return `
          <div class="min-h-full w-full p-4 md:p-8">
            <div class="max-w-4xl mx-auto">

              <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                  <span class="font-display text-sm opacity-70" style="font-size:${fontSize * 0.75}px">Year ${scenario.year} of 5</span>
                  <span class="text-sm opacity-70" style="font-size:${fontSize * 0.75}px">${gameState.currentScenario + 1} / ${scenarios.length}</span>
                </div>

                <div class="h-2 rounded-full overflow-hidden" style="background:${surfaceColor}">
                  <div class="h-full progress-bar rounded-full" style="width:${progressPct}%; background:${primaryAction}"></div>
                </div>

                <div class="flex justify-between mt-3">
                  ${[1,2,3,4,5].map(y => `
                    <div class="flex flex-col items-center">
                      <div class="timeline-dot w-3 h-3 rounded-full ${scenario.year >= y ? 'active' : ''}"
                        style="background:${scenario.year >= y ? primaryAction : surfaceColor}"></div>
                      <span class="text-xs mt-1 opacity-50" style="font-size:${fontSize * 0.625}px">Yr ${y}</span>
                    </div>
                  `).join('')}
                </div>
              </div>

              <div class="flex items-center gap-3 mb-6 animate-slide">
                <span class="text-4xl">${char.emoji}</span>
                <div>
                  <div class="font-display font-bold" style="font-size:${fontSize * 1.125}px">${char.name}</div>
                  <div class="text-sm opacity-60" style="font-size:${fontSize * 0.75}px">${char.identity}</div>
                </div>
                <div class="ml-auto text-right">
                  <div class="font-display font-bold" style="color:${secondaryAction}; font-size:${fontSize * 1.25}px">$${stats.salary.toLocaleString()}</div>
                  <div class="text-xs opacity-60" style="font-size:${fontSize * 0.625}px">Current Salary</div>
                </div>
              </div>

              <div class="stat-card rounded-2xl p-6 md:p-8 mb-6 animate-fade" style="background:${surfaceColor}">
                <div class="text-sm font-display opacity-60 mb-2" style="font-size:${fontSize * 0.75}px; color:${secondaryAction}">
                  YEAR ${scenario.year}
                </div>

                <h2 class="font-display font-bold mb-4" style="font-size:${fontSize * 1.75}px">
                  ${scenario.title}
                </h2>

                <p class="text-lg opacity-90 mb-6" style="font-size:${fontSize * 1.125}px">
                  ${scenario.situations[charKey]}
                </p>

                <div class="border-t pt-6" style="border-color:${textColor}20">
                  <div class="text-sm font-display opacity-60 mb-3" style="font-size:${fontSize * 0.75}px">
                    WHAT HAPPENS:
                  </div>
                  <div class="rounded-xl p-4 mb-4" style="background:${primaryAction}20; border-left:4px solid ${primaryAction}">
                    <p class="leading-relaxed" style="font-size:${fontSize}px">
                      ${outcome.text}
                    </p>
                  </div>

                  <div class="flex flex-wrap gap-2 mt-4">
                    ${outcome.salaryChange ? `
                      <span class="px-3 py-1 rounded-full text-sm font-medium"
                        style="background:${outcome.salaryChange > 0 ? '#10b98120' : '#ef444420'};
                               color:${outcome.salaryChange > 0 ? '#10b981' : '#ef4444'};
                               font-size:${fontSize * 0.875}px">
                        ${outcome.salaryChange > 0 ? '+' : ''}$${outcome.salaryChange.toLocaleString()} salary
                      </span>` : ''}

                    ${outcome.promoted === true ? `
                      <span class="px-3 py-1 rounded-full text-sm font-medium"
                        style="background:#10b98120; color:#10b981; font-size:${fontSize * 0.875}px">
                        üéâ Promoted
                      </span>` : outcome.promoted === false ? `
                      <span class="px-3 py-1 rounded-full text-sm font-medium"
                        style="background:#ef444420; color:#ef4444; font-size:${fontSize * 0.875}px">
                        ‚ùå Not selected
                      </span>` : ''}

                    ${outcome.confidenceChange ? `
                      <span class="px-3 py-1 rounded-full text-sm font-medium"
                        style="background:${outcome.confidenceChange > 0 ? '#10b98120' : '#ef444420'};
                               color:${outcome.confidenceChange > 0 ? '#10b981' : '#ef4444'};
                               font-size:${fontSize * 0.875}px">
                        ${outcome.confidenceChange > 0 ? '‚Üë' : '‚Üì'} Confidence
                      </span>` : ''}

                    ${outcome.burnoutChange >= 15 ? `
                      <span class="px-3 py-1 rounded-full text-sm font-medium"
                        style="background:#f59e0b20; color:#f59e0b; font-size:${fontSize * 0.875}px">
                        ‚ö†Ô∏è Burnout risk
                      </span>` : ''}

                    ${outcome.mentorChange > 0 ? `
                      <span class="px-3 py-1 rounded-full text-sm font-medium"
                        style="background:#10b98120; color:#10b981; font-size:${fontSize * 0.875}px">
                        ü§ù +${outcome.mentorChange} Mentor
                      </span>` : ''}
                  </div>
                </div>
              </div>

              ${scenario.stat ? `
                <div class="stat-card rounded-2xl p-6 mb-6 animate-fade"
                  style="background:linear-gradient(135deg, ${primaryAction}30, ${secondaryAction}30)">
                  <div class="flex items-start gap-4">
                    <div class="text-3xl">üìä</div>
                    <div>
                      <div class="font-display font-bold mb-2" style="color:${primaryAction}; font-size:${fontSize * 1.125}px">
                        ${scenario.stat.title}
                      </div>
                      <p class="leading-relaxed" style="font-size:${fontSize}px">${scenario.stat.value}</p>
                      ${scenario.stat.source ? `<p class="text-xs opacity-50 mt-2" style="font-size:${fontSize * 0.625}px">Source: ${scenario.stat.source}</p>` : ''}
                    </div>
                  </div>
                </div>` : ''}

              ${scenario.solutions ? `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 animate-fade">
                  <div class="rounded-2xl p-6" style="background:${primaryAction}15; border-left:4px solid ${primaryAction}">
                    <div class="font-display font-bold mb-3" style="color:${primaryAction}; font-size:${fontSize * 1.125}px">
                      üí™ What You Can Do
                    </div>
                    <div class="space-y-2">
                      ${scenario.solutions.forIndividuals.map(sol => `
                        <div>
                          <div class="font-semibold text-sm mb-1" style="font-size:${fontSize * 0.875}px">${sol.title}</div>
                          <div class="text-xs opacity-80" style="font-size:${fontSize * 0.75}px">${sol.desc}</div>
                        </div>
                      `).join('')}
                    </div>
                  </div>

                  <div class="rounded-2xl p-6" style="background:${secondaryAction}15; border-left:4px solid ${secondaryAction}">
                    <div class="font-display font-bold mb-3" style="color:${secondaryAction}; font-size:${fontSize * 1.125}px">
                      ü§ù What Leaders Should Do
                    </div>
                    <div class="space-y-2">
                      ${scenario.solutions.forLeaders.map(sol => `
                        <div>
                          <div class="font-semibold text-sm mb-1" style="font-size:${fontSize * 0.875}px">${sol.title}</div>
                          <div class="text-xs opacity-80" style="font-size:${fontSize * 0.75}px">${sol.desc}</div>
                        </div>
                      `).join('')}
                    </div>
                  </div>
                </div>` : ''}

              <div class="flex justify-between items-center">
                <button onclick="switchCharacterTemporarily()"
                  class="px-4 py-2 rounded-lg font-medium transition-all hover:scale-105"
                  style="background:${surfaceColor}; font-size:${fontSize * 0.875}px">
                  üëÄ See other paths
                </button>

                <button onclick="nextScenario()"
                  class="px-6 py-3 rounded-xl font-semibold transition-all hover:scale-105"
                  style="background:${primaryAction}; color:white; font-size:${fontSize}px">
                  ${gameState.currentScenario < scenarios.length - 1 ? 'Continue ‚Üí' : 'See Final Results ‚Üí'}
                </button>
              </div>
            </div>
          </div>
        `;
      }

      function renderFinalStats(surfaceColor, textColor, primaryAction, secondaryAction, fontSize) {
        const salaryGap = gameState.alexStats.salary - gameState.jordanStats.salary;

        const cards = Object.keys(characters).map((k) => {
          const c = characters[k];
          const s = getStats(k);
          return `
            <div class="stat-card rounded-2xl p-6" style="background:${surfaceColor}">
              <div class="flex items-center gap-3 mb-4">
                <span class="text-4xl">${c.emoji}</span>
                <div>
                  <div class="font-display font-bold" style="font-size:${fontSize * 1.25}px">${c.name}</div>
                  <div class="text-sm opacity-60" style="font-size:${fontSize * 0.75}px">${c.identity}</div>
                </div>
              </div>
              <div class="space-y-3">
                <div class="flex justify-between"><span class="opacity-70">Salary</span><span class="font-display font-bold">$${s.salary.toLocaleString()}</span></div>
                <div class="flex justify-between"><span class="opacity-70">Promotions</span><span class="font-semibold">${s.promotions}</span></div>
                <div class="flex justify-between"><span class="opacity-70">Mentors</span><span class="font-semibold">${s.mentors}</span></div>
                <div class="flex justify-between"><span class="opacity-70">Confidence</span><span class="font-semibold">${clamp(s.confidence,0,100)}%</span></div>
                <div class="flex justify-between"><span class="opacity-70">Burnout</span><span class="font-semibold">${clamp(s.burnout,0,100)}%</span></div>
              </div>
            </div>
          `;
        }).join('');

        return `
          <div class="min-h-full w-full p-4 md:p-8 overflow-auto">
            <div class="max-w-5xl mx-auto">
              <div class="text-center mb-8 animate-fade">
                <h1 class="font-display font-bold mb-4" style="font-size:${fontSize * 2.5}px">Five Years Later</h1>
                <p class="opacity-80" style="font-size:${fontSize * 1.25}px; color:${secondaryAction}">
                  Same talent. Same effort. Different outcomes.
                </p>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                ${cards}
              </div>

              <div class="stat-card rounded-2xl p-6 md:p-8 mb-8" style="background:linear-gradient(135deg, ${primaryAction}20, ${secondaryAction}20)">
                <h3 class="font-display font-bold mb-3 text-center" style="font-size:${fontSize * 1.5}px">One Example Gap</h3>
                <p class="text-center opacity-80" style="font-size:${fontSize}px">
                  Alex vs Jordan salary difference (in this simulation): <span class="font-display font-bold" style="color:#ef4444">$${salaryGap.toLocaleString()}</span>
                </p>
              </div>

              <div class="stat-card rounded-2xl p-6 md:p-8 text-center" style="background:linear-gradient(135deg, ${primaryAction}, ${secondaryAction})">
                <h3 class="font-display font-bold mb-4 text-white" style="font-size:${fontSize * 1.75}px">What Can We Do?</h3>
                <p class="mb-6 text-white opacity-90" style="font-size:${fontSize * 1.125}px">
                  Change comes from making access and evaluation more fair: clearer criteria, better sponsorship, and more equitable opportunities.
                </p>
                <button onclick="resetGame()"
                  class="px-6 py-3 rounded-xl font-semibold transition-all hover:scale-105"
                  style="background:white; color:${primaryAction}; font-size:${fontSize}px">
                  üîÑ Play Again
                </button>
              </div>
            </div>
          </div>
        `;
      }
function renderEmpowerment(surfaceColor, textColor, primaryAction, secondaryAction, fontSize) {
  const mbTechWeekUrl = 'https://mbtechweek.ca/events/list/';

  // You can edit this table anytime (it‚Äôs just data)
  const eventMap = [
    {
      struggle: "You‚Äôre doing fine‚Ä¶ but you feel a bit on the outside.",
      events: [
        "Ignition (MbTech Week launch)",
        "Creative Careers: Manitoba-Made Innovation",
        "Founders Coffee: Presented by Futurpreneur",
        "Speed Networking: IT Sector",
        "IDEA START AI TALK Series"
      ],
      why: "Low-pressure ways to meet people, hear real stories, and build a few friendly faces in the community."
    },
    {
      struggle: "You‚Äôve got skills, but confidence is wobbly (hello, imposter syndrome).",
      events: [
        "Breaking the Code of Confidence (women in tech panel)"
      ],
      why: "Practical strategies and honest stories‚Äîwithout the cringe."
    },
    {
      struggle: "You‚Äôre tired of subtle stereotypes about who ‚Äòfits‚Äô in tech.",
      events: [
        "Rethinking Cybersecurity: Breaking the Myths Holding Women Back"
      ],
      why: "Names the bias without turning anyone into a cartoon villain‚Äîand gives language for what you‚Äôre seeing."
    },
    {
      struggle: "You want career momentum, but you don‚Äôt have the same ‚Äòbuilt-in‚Äô network.",
      events: [
        "Speed Networking: IT Sector"
      ],
      why: "A structured way to connect (no awkward ‚Äòso‚Ä¶ what do you do?‚Äô loops)."
    },
    {
      struggle: "You want to see what Manitoba‚Äôs tech scene actually looks like‚Äîand where you fit.",
      events: [
        "CreativeMornings Winnipeg",
        "Creative Careers: Manitoba-Made Innovation"
      ],
      why: "Helps you picture possible paths‚Äîand reminds you there isn‚Äôt one ‚Äòright‚Äô kind of tech person."
    },
    {
      struggle: "You care about people + community impact, not just ‚Äòmove fast and break things.‚Äô",
      events: [
        "Tech for Good: Aging Well and Supporting Families & Community"
      ],
      why: "Connects tech to real life‚Äîcare, accessibility, and the stuff that actually matters."
    },
    {
      struggle: "You‚Äôre a people leader (or a quiet leader). You want your team to feel better than this.",
      events: [
        "Ignition (MbTech Week launch)",
        "Creative Careers: Manitoba-Made Innovation"
      ],
      why: "Go with your team. Talk after. Ask: ‚ÄòWhat felt familiar? What would make this easier here?‚Äô"
    }
  ];

  const rows = eventMap.map(r => `
    <tr style="border-top: 1px solid ${textColor}20;">
      <td class="align-top py-3 pr-3" style="font-size:${fontSize * 0.9}px; width: 28%;">
        <div class="font-semibold">${r.struggle}</div>
      </td>
      <td class="align-top py-3 pr-3" style="font-size:${fontSize * 0.9}px; width: 40%;">
        <ul class="list-disc pl-5 space-y-1">
          ${r.events.map(e => `<li>${e}</li>`).join('')}
        </ul>
      </td>
      <td class="align-top py-3" style="font-size:${fontSize * 0.9}px; width: 32%;">
        <div class="opacity-90">${r.why}</div>
      </td>
    </tr>
  `).join('');

  return `
    <div class="min-h-full w-full p-4 md:p-8 overflow-auto">
      <div class="max-w-5xl mx-auto animate-fade">

        <div class="text-center mb-8">
          <div class="text-5xl mb-3">üß≠</div>
          <h2 class="font-display font-bold mb-3" style="font-size:${fontSize * 2}px;">
            If This Felt Familiar
          </h2>
          <p class="opacity-80 mx-auto" style="max-width: 52rem; font-size:${fontSize * 1.1}px; color:${textColor}">
            You‚Äôre not ‚Äútoo sensitive.‚Äù And you‚Äôre not alone.
            Sometimes the challenge isn‚Äôt one big moment ‚Äî it‚Äôs the extra friction.
            The good news: there are real, practical ways to build confidence, connections, and momentum.
          </p>
        </div>

        <div class="stat-card rounded-2xl p-6 md:p-8 mb-6" style="background:${surfaceColor}">
          <h3 class="font-display font-bold mb-3" style="font-size:${fontSize * 1.25}px; color:${primaryAction}">
            What to do next (the simple version)
          </h3>
          <ul class="list-disc pl-5 space-y-2" style="font-size:${fontSize}px;">
            <li><span class="font-semibold">Pick one event</span> that matches what you‚Äôre feeling. You don‚Äôt need to ‚Äúdo everything.‚Äù</li>
            <li><span class="font-semibold">Bring a buddy</span> if you can. If not, set a tiny goal: ‚Äútalk to one person.‚Äù</li>
            <li><span class="font-semibold">If you lead people</span> (title or not): go with curiosity. Notice who speaks, who gets interrupted, who gets credit.</li>
            <li><span class="font-semibold">Afterward</span>, ask: ‚ÄúWhat would make our workplace easier for someone new?‚Äù Then actually change one thing.</li>
          </ul>
        </div>

        <div class="stat-card rounded-2xl p-6 md:p-8 mb-6" style="background:${surfaceColor}">
          <div class="flex items-start gap-3 mb-4">
            <div class="text-3xl">üìÖ</div>
            <div>
              <h3 class="font-display font-bold" style="font-size:${fontSize * 1.25}px;">
                Manitoba Tech Week picks (matched to the struggles in this game)
              </h3>
              <p class="opacity-70" style="font-size:${fontSize * 0.9}px;">
                These are straight from the MB Tech Week events list. Use this like a menu.
              </p>
            </div>
          </div>

          <div class="overflow-auto rounded-xl" style="border: 1px solid ${textColor}20;">
            <table class="w-full" style="border-collapse: collapse;">
              <thead style="background:${textColor}08;">
                <tr>
                  <th class="text-left py-3 px-4" style="font-size:${fontSize * 0.85}px;">If you‚Äôre feeling‚Ä¶</th>
                  <th class="text-left py-3 px-4" style="font-size:${fontSize * 0.85}px;">Try these events</th>
                  <th class="text-left py-3 px-4" style="font-size:${fontSize * 0.85}px;">Why it helps</th>
                </tr>
              </thead>
              <tbody class="px-4">
                ${rows.replaceAll('<td', '<td class="px-4"')}
              </tbody>
            </table>
          </div>

          <div class="mt-4">
            <a href="${mbTechWeekUrl}" target="_blank" rel="noopener"
               class="inline-flex items-center gap-2 font-semibold underline"
               style="color:${primaryAction}; font-size:${fontSize}px;">
              See the full Manitoba Tech Week event list ‚Üí
            </a>
          </div>
        </div>

        <div class="text-center">
          <button onclick="resetGame()"
            class="px-6 py-3 rounded-xl font-semibold transition-all hover:scale-105"
            style="background:${primaryAction}; color:white; font-size:${fontSize}px;">
            üîÑ Play Again
          </button>
        </div>

      </div>
    </div>
  `;
}

      
      // ---------------------------
      // Game functions
      // ---------------------------
      function startGame() {
        gameState.screen = 'select';
        render();
      }

      function selectCharacter(charKey) {
        gameState.selectedCharacter = charKey;
        render();
      }

      function beginScenarios() {
        if (!gameState.selectedCharacter) return;

        gameState.screen = 'playing';
        gameState.currentScenario = 0;

        Object.keys(characters).forEach((charKey) => {
          gameState[`${charKey}Stats`] = { ...startingStatsByCharacter[charKey] };
        });

        render();
      }

      function applyScenarioToAllCharacters(scenario) {
        Object.keys(characters).forEach((charKey) => {
          const outcome = scenario.outcomes?.[charKey];
          if (!outcome) return;

          const stats = getStats(charKey);
          stats.salary += outcome.salaryChange || 0;
          stats.confidence += outcome.confidenceChange || 0;
          stats.burnout += outcome.burnoutChange || 0;
          stats.mentors += outcome.mentorChange || 0;

          if (outcome.promoted === true) stats.promotions += 1;
        });
      }

      function nextScenario() {
        const scenario = scenarios[gameState.currentScenario];
        applyScenarioToAllCharacters(scenario);

        if (gameState.currentScenario < scenarios.length - 1) {
          gameState.currentScenario += 1;
          render();
        } else {
          gameState.screen = 'stats';
          render();
        }
      }

      function switchCharacterTemporarily() {
        const keys = Object.keys(characters);
        const current = gameState.selectedCharacter;
        const idx = keys.indexOf(current);
        const next = keys[(idx + 1) % keys.length];
        gameState.selectedCharacter = next;
        render();
      }

      function resetGame() {
        gameState = {
          screen: 'intro',
          selectedCharacter: null,
          currentScenario: 0,
          alexStats: { ...startingStatsByCharacter.alex },
          jordanStats: { ...startingStatsByCharacter.jordan },
          priyaStats: { ...startingStatsByCharacter.priya },
          jerry_indigenousStats: { ...startingStatsByCharacter.jerry_indigenous }
        };
        render();
      }

      // Expose functions for onclick
      window.startGame = startGame;
      window.selectCharacter = selectCharacter;
      window.beginScenarios = beginScenarios;
      window.nextScenario = nextScenario;
      window.switchCharacterTemporarily = switchCharacterTemporarily;
      window.resetGame = resetGame;

      // Boot
      render();
    </script>
  </body>
</html>
